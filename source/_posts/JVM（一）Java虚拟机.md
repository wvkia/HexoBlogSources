---
title: JVM（一）Java虚拟机
date: 2018-04-26 23:26:17
tags: [JVM]
---
#### Java虚拟机
	虚拟机是抽象化的计算机，通过在实际计算机上仿真模拟各种计算机功能来实现的。Java虚拟机有自己的硬件架构，如果处理器、堆栈、寄存器等，还有相应的指令系统。JVM屏蔽了和具体操作系统平台的信息，使得Java程序只需生成在JVM上运行的目标代码（字节码），就可以正确运行。
##### JVM的产生
为了屏蔽操作系统的具体信息，使得Java代码可以在不同的操作系统无差别运行。

从进程角度看待：
 + 从这个角度看，JVM只是一个普通的应用进程，当我们Java代码需要运行时，会首先启动JVM这个进程，然后JVM对Class文件进行加载解析，解释class字节码指令，然后把这些字节码指令翻译成本机CPU可以识别的指令，再到CPU上运行。
 + 同时JVM进行还会会处理一些低层的操作，例如内存的分配和回收。
 + 一个JVM虚拟机在运行时会有三个子系统来保证它的正常运行
  - 类加载器子系统
  - 执行引擎子系统
  - 垃圾回收子系统

从具体实例来了解三个系统的作用：

- 我们编写的Java代码会首先被编译成Class文件，这个是JVM可以识别的标准文件，编译之后的class文件是作为JVM的原料被输入到JVM内部，这个把Class文件加载到JVM内部的工作就由类加载器子系统进行，这个子系统用来在运行时“根据需要”加载类。注意“根据需要”这个关键字。Java虚拟机执行的过程中，只有在它需要某一个类的时候，才会调用类加载器子系统来加载这个类，并不会在开始运行的时候就加载所有的类，就像一个人饿了才会吃饭，不会一次把一年的饭都吃了。通常，虚拟机在第一次使用某个类的时候才会加载这个类对应的class文件，这个后续会说到具体类加载器工作原理。

- 由类加载器子系统加载的类，被加载到Java虚拟机内存之后，虚拟机会读取并且执行它里面的字节码指令。执行字节码指令的部分就是执行引擎子系统。类似人类的消化系统。在执行过程中还会把各个class文件动态链接起来。

- Java虚拟机会对内存进行自动管理，就是合理的分配内存并且自动释放没有用的对象，不需要程序手动编码。这部分工作就是由垃圾回收子系统完成。
![](jvmsubsystem.png)

#### JDK
JRE:Java Runtime Environment  Java运行时环境
	包括Java虚拟机和基础类库，运行Java程序需要的
JDK:Java Development Kit Java开发工具包
	包括JRE和工具，开发Java程序需要的
![](jdk.png)
